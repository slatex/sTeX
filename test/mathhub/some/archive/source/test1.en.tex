\def\mathhub{../../..}
\documentclass[debug=all]{stex}
\libinput{preamble}

\begin{document}

\noindent Document \printdocument

\begin{smodule}{test1}

  \symdecl*{foo bar}
  \symdecl{foo}[name=bar baz]

  \sn{foo bar} and \sn{foo}

  \symname{foo} \hasdefiniens{foo}

  \symdef{testaa}[args=ii]{\comp\langle #1 \maincomp+ #2 \comp\rangle}

  \begin{sdefinition}
    Definiendum \definame{foo} is defined as $\definiens[foo]{\alpha}$.

    Also: $\defnotation{\testaa xy}$
  \end{sdefinition}

  \symname{foo} \hasdefiniens{foo}

  A definition with symbol declaration:
  \begin{sdefinition}[macro=testab,args=2,type=\testaa xy]
    \notation{testab}{\comp\langle #1 \maincomp+ #2 \comp\rangle}
    $\defnotation{\testab xy}$ is defined as $\definiens{\testaa xy}$.
  \end{sdefinition}

  \symname{testab} \hasdefiniens{testab}

  Inline: \inlinedef[macro=testac,args=2,type=\testaa xy]{
    \notation{testac}{\comp\langle #1 \maincomp+ #2 \comp\rangle}
    $\defnotation{\testac xy}$ is defined as $\definiens{\testaa xy}$.%
  } \symname{testac} \hasdefiniens{testac}.

  Paragraph:
  \begin{sparagraph}[style=symdoc,macro=testad,args=2,type=\testaa xy]
    \notation{testad}{\comp\langle #1 \maincomp+ #2 \comp\rangle}
    $\defnotation{\testad xy}$ is defined as $\definiens{\testaa xy}$.
  \end{sparagraph}

\end{smodule}

\begin{smodule}{test2}

  \symdef{complex}[name=some really complex thing,args=iii]
    { \comp\langle #1 \maincomp{c}_{#2}^{#3} \comp\rangle }

  Term: $\complex abc$\\
  Operator: $\complex!$

  \notation{complex}[b]{ \comp( {}^{#1}_{#2}\maincomp{c_b}^{#3} \comp)}
  \begin{mathstructure}{somestruct}[some struct]
    \symdef{univ}{\mathcal U}
    \symdef{op}[args=a]{\argsep{#1}{\mathbin{\maincomp\circ}}}

    In structure: $\op{\svar a,\svar b,\svar c}$
  \end{mathstructure}

  \symdef{somestructfoo}[return=\somestruct]{\mathcal F}

  Tests: $\somestructfoo!$ and $\somestructfoo{}$ and $\somestructfoo{univ}$ and $\somestructfoo{op}!$ and
  $\somestructfoo{op}{\svar a,\svar b,\svar c}$

  \symdef{somestructfootoo}[return={\somestruct[comp=\langle \comp{##1} \rangle]}]{\mathcal F}

\end{smodule}

\end{document}