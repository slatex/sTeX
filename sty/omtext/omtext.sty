%%
%% This is file `omtext.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% omtext.dtx  (with options: `package')
%% 
\NeedsTeXFormat{LaTeX2e}[1999/12/01]
\ProvidesPackage{omtext}[2012/11/06 v1.0 OMDoc Text Fragments]
\DeclareOption{showmeta}{\PassOptionsToPackage{\CurrentOption}{metakeys}}
\newif\ifindex\indextrue
\DeclareOption{noindex}{\indexfalse}
\ProcessOptions
\ifindex\makeindex\fi
\RequirePackage{sref}
\RequirePackage{xspace}
\RequirePackage{modules}
\RequirePackage{comment}
\srefaddidkey{omtext}
\addmetakey[]{omtext}{functions}
\addmetakey*{omtext}{display}
\addmetakey{omtext}{for}
\addmetakey{omtext}{from}
\addmetakey{omtext}{type}
\addmetakey*{omtext}{title}
\addmetakey*{omtext}{start}
\addmetakey{omtext}{theory}
\addmetakey{omtext}{continues}
\addmetakey{omtext}{verbalizes}
\addmetakey{omtext}{subject}
\define@key{omtext}{require}{\requiremodules{#1}{sms}}
\define@key{omtext}{module}{\message{module: #1}\importmodule{#1}\def\omtext@theory{#1}}
\def\st@flow{flow}
\def\omtext@pre@skip{\smallskip}
\def\omtext@post@skip{}
\providecommand{\stDMemph}[1]{\textbf{#1}}
\newenvironment{omtext}[1][]{\bgroup\metasetkeys{omtext}{#1}\sref@label@id{this paragraph}%
\def\lec##1{\@lec{##1}}%
\ifx\omtext@display\st@flow\else\omtext@pre@skip\par\noindent%
\ifx\omtext@title\@empty%
\ifx\omtext@start\@empty\else\stDMemph{\omtext@start}\xspace\fi%
\else\stDMemph{\omtext@title}:\xspace%
\ifx\omtext@start\@empty\else\omtext@start\xspace\fi%
\fi% omtext@title empty
\fi% omtext@display=flow
\ignorespaces}
{\egroup\omtext@post@skip}
\srefaddidkey{phrase}
\addmetakey{phrase}{style}
\addmetakey{phrase}{class}
\addmetakey{phrase}{index}
\addmetakey{phrase}{verbalizes}
\addmetakey{phrase}{type}
\addmetakey{phrase}{only}
\newcommand\phrase[2][]{\metasetkeys{phrase}{#1}%
\ifx\prhase@only\@empty\only<\phrase@only>{#2}\else #2\fi}
\def\nlex#1{\green{\sl{#1}}}
\def\nlcex#1{*\green{\sl{#1}}}
\def\@sinlinequote#1{``{\sl{#1}}''}
\def\@@sinlinequote#1#2{\@sinlinequote{#2}~#1}
\newcommand\sinlinequote[2][]
{\def\@opt{#1}\ifx\@opt\@empty\@sinlinequote{#2}\else\@@sinlinequote\@opt{#2}\fi}
\def\begin@sblockquote{\begin{quote}\sl}
\def\end@sblockquote{\end{quote}}
\def\begin@@sblockquote#1{\begin@sblockquote}
\def\end@@sblockquote#1{\def\@@lec##1{{\rm ##1}}\@lec{#1}\end@sblockquote}
\newenvironment{sblockquote}[1][]
  {\def\@opt{#1}\ifx\@opt\@empty\begin@sblockquote\else\begin@@sblockquote\@opt\fi}
  {\ifx\@opt\@empty\end@sblockquote\else\end@@sblockquote\@opt\fi}
\providecommand{\@@lec}[1]{(#1)}
\def\@lec#1{\strut\hfil\strut\null\nobreak\hfill\hbox{\@@lec{#1}}}
\def\lec#1{\@lec{#1}\par}
\newcommand\mygraphics[2][]{\includegraphics[#1]{#2}}
\newcommand\mycgraphics[2][]{\begin{center}\mygraphics[#1]{#2}\end{center}}
\newcommand\mybgraphics[2][]{\fbox{\mygraphics[#1]{#2}}}
\newcommand\omdoc@index[2][]{\ifindex\def\@test{#1}%%
\ifx\@test\@empty\def\@@idx{#2}\else\def\@@idx{#1}\fi%
\@bsphack\begingroup\@sanitize%
\@ifundefined{mod@id}% if we are not in a module
{\protected@write\@indexfile{}{\string\indexentry%
{\@@idx @\string\importmodules{\imported@modules}#2}{\thepage}}}%
{\protected@write\@indexfile{}{\string\indexentry%
{\@@idx @\string\importmodules{\mod@id}#2}{\thepage}}}%
\endgroup\@esphack}
\newcommand\indexalt[3][]{{#2}\omdoc@index[#1]{#3}}               % word in text and index
\newcommand\indextoo[2][]{{#2}\omdoc@index[#1]{#2}}               % word in text and index
\newcommand\@twin[3][]{\ifindex\def\@test{#1}%%
\ifx\@test\@empty\def\@@idx{#2}\else\def\@@idx{#1}\fi%
\@ifundefined{mod@id}%
{\index{\@@idx @#2!#3}%
\ifx\@test\@empty\def\@@idx{#3}\else\def\@@idx{#1}\fi%
\index{\@@idx @#2!#3}}%
{\index{\@@idx @{\importmodule{\mod@id} #2}!{\importmodule{\mod@id} #3}}%
\ifx\@test\@empty\def\@@idx{#3}\else\def\@@idx{#1}\fi%
\index{\@@idx @{\importmodule{\mod@id} #3}!{\importmodule{\mod@id} #2}}\fi}}
\newcommand\twinalt[4][]{#2\@twin[#1]{#3}{#4}}
\newcommand\twintoo[3][]{{#2 #3}\@twin[#1]{#2}{#3}} % and use the word compound too
\newcommand\@atwin[4][]{\ifindex\def\@test{#1}%%
\ifx\@test\@empty\def\@@idx{#2}\else\def\@@idx{#1}\fi%
\@ifundefined{mod@id}%
{\index{\@@idx @#2!#3!#4}%
\ifx\@test\@empty\def\@@idx{#3}\else\def\@@idx{#1}\fi%
\index{\@@idx @#3!#2 (#4)}}%
{\index{\@@idx @{\importmodule{\mod@id} #2}%
!{\importmodule{\mod@id} #3}!{\importmodule{\mod@id} #4}}%
\ifx\@test\@empty\def\@@idx{#3}\else\def\@@idx{#1}\fi%
\index{\@@idx @{\importmodule{\mod@id} #3}%
!{\importmodule{\mod@id} #2} ({\importmodule{\mod@id} #4})}\fi}}
\newcommand\atwinalt[5][]{#2\@atwin[#1]{#3}{#4}{#4}}
\newcommand\atwintoo[4][]{{#2 #3 #4}\@atwin[#1]{#2}{#3}{#4}}         % and use it too
\def\omspace#1{\hspace*{#1}}
\addmetakey{Gin}{mhrepos}
\newcommand\mhgraphics[2][]{\setkeys{Gin}{#1}%
\ifx\Gin@mhrepos\@empty\mygraphics[#1]{\MathHub{\mh@currentrepos/source/#2}}%
\else\mygraphics[#1]{\MathHub{\Gin@mhrepos/source/#2}}\fi}
\newcommand\mhcgraphics[2][]{\begin{center}\mhgraphics[#1]{#2}\end{center}}
\newcommand\mhbgraphics[2][]{\fbox{\mhgraphics[#1]{#2}}}
\endinput
%%
%% End of file `omtext.sty'.
